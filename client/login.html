<!DOCTYPE html>
<html lang="pt-br" class="h-100">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Fonte -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
  </head>
  <body class="d-flex align-items-center py-4 bg-body-tertiary h-100">
    <main class="w-100 m-auto form-container">
      <form id="loginForm">
        <h1 class="h3 mb-3 fw-normal" style="color: #6b8e23">
          Acesse sua conta
        </h1>
        <div class="form-floating">
          <input
            type="email"
            class="form-control"
            id="floatingInputEmail"
            placeholder="Digite o seu e-mail"
          />
          <label for="floatingInput">E-mail</label>
        </div>
        &ensp;&ensp;
        <div class="form-floating">
          <input
            type="password"
            class="form-control"
            id="floatingInputPassword"
            placeholder="Digite sua senha"
          />
          <label for="floatingInput">Senha</label>
        </div>
        <div class="form-check text-start my-3" style="color: #fff">
          <input
            type="checkbox"
            class="form-check-input"
            id="flexCheckDefault"
          />
          <label class="form-check-label" for="flexCheckDefault"
            >Manter Login</label
          >
        </div>
        &ensp;&ensp;
        <button class="btn btn-light w-100 py-2">Entrar</button>
        &ensp;
        <button type="button" class="btn btn-light w-100 py-2">
          <a href="cadastro.html">Não tem uma conta? Cadastre-se!</a>
        </button>
        <p class="text-body-primary mt-4 mb-3" style="color: #fff">
          © Clube do Livro
        </p>
      </form>
    </main>

    <script>
      document
        .getElementById("loginForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const email = document.getElementById("floatingInputEmail").value;
          const password = document.getElementById(
            "floatingInputPassword"
          ).value;

          const loginData = {
            email: email,
            password: password
          };

          fetch("http://localhost:8000/api/v1/users/login", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(loginData),
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                // caso o login seja bem sucedido, avisa que deu certo e redireciona para a tela de gestão administrativa
                alert("Login feito com sucesso!");
                window.location.href = "index.html"; //redirecionar para a tela de gestão administrativa
              } else {
                // Hcaso o login falhe, avisar que deu errado
                alert("Login falhou: " + data.message);
              }
            })
            .catch((error) => {
              console.error("Error:", error);
              alert("Ocorreu um erro enquanto logava.");
            });
        });
    </script>
  </body>
</html>
